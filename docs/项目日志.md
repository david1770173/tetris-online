<!--
 * @Author: vic123 zhangzc_efz@163.com
 * @Date: 2024-05-27 21:43:30
 * @LastEditors: vic123 zhangzc_efz@163.com
 * @LastEditTime: 2024-06-01 17:59:26
 * @FilePath: \SFML-snake\docs\项目日志.md
 * @Description: 
 * 
 * Copyright (c) 2024 by vic123, All Rights Reserved. 
-->
## 2024-5-27
## 配置SFML
### 使用cmake-sfml template：

下载：`git clone https://github.com/SFML/cmake-sfml-project.git`

配置：使用vscode cmake插件一键build

该命令会执行本项目目录下的cmakelists，下载sfml项目仓库，并根据sfml项目中包含的cmakelists对sfml进行编译。以后，如果我们在本项目中写的源文件有include <SFML/...>，在编译时就直接把编译好的sfml组件给静态链接进来。

验证：
cmake-sfml template自带一个例子程序 main.cpp。用cmake编译main之后，执行main.exe，显示一个黑色窗口，说明sfml已经被配置好了。

### 调通别人的俄罗斯方块
下载：`git clone https://github.com/terroo/tetris`

把源文件挪到cmake-sfml-project/src下，resources挪到cmake-sfml-project下。

在cmakelists里加入：`add_executable(main src/main.cpp src/tetris.cpp)`

编译运行，工作正常：![alt text](image.png)

## 2024-5-29
### 设计
![alt text](微信图片_20240529235847.jpg)
### feature：wasd、鼠标控制
现在可以使用wasd/鼠标控制贪吃蛇
### feature:多蛇
### feature:碰撞检测
### 遇到的bug
程序不调用pollEvent，鼠标左键导致闪退

原因：https://www.reddit.com/r/sfml/comments/85g1aj/why_is_my_engine_crashing_whenever_i_click_the/
![alt text](image-2.png)
### 有待思考的问题
食物被吃的判断在foodManager里做还是snakeManager里做？

要不要把foodManager写成snakeManager的一个成员变量？

食物飞向蛇头的动画怎么实现？
### 可以改进的地方
1. 把Manager写成单例模式
2. 蛇的随机外观渲染，随机初始化
3. collision运算量优化

## 2024-5-30
### todo
突然意识到用vector存蛇身效率很低，每次移动的时间复杂度是O(n)。改成双端队列更合适。
checked

### 将蛇身的数据结构改为deque
好家伙，把数据类型改完之后，只需要把首元素插入改掉就编译通过了，赞美多态。

![alt text](image-4.png)![alt text](image-3.png)

### 进展
优化：食物吸引距离从范数改成曼哈顿距离

从食物被吃掉后销毁，隔固定时间创建，改成被吃掉后随机重生

change snakeBody datastruct from vector to deque

food velocity unlink from framerate

蛇身变大变小

### feature
蛇头角速度限制

## 2024-5-31
### feature
蛇身随变长变大

### major update (Screen Management)
加入页面管理系统

页面基类：IScreen

页面管理：ScreenManager

目前的页面：gameScreen pauseScreen

### major update (UIComponent)
UI基类：IUIComponent

UI组件：Button

### warning
偶然间，在不插电的情况下玩了一会儿，出乎意料的卡起来了？这并不合理，游戏里一共只有7个texture，batching之后gpu只需要算7次。

破案了，SFML不直接提供对draw的batching，要用VertexArray